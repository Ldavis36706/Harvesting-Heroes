<h2>Enter Harvest Data</h2>
<form id="harvestForm">
    <label for="plantName">Plant Name:</label>
    <select id="plantName" required>
        <option value="">Select a plant</option>
    </select>

    <label for="harvestDate">Harvest Date:</label>
    <input type="date" id="harvestDate" required>

    <label for="location">Harvest Location:</label>
    <select id="location" required>
        <option value="">Select a location</option>
        <option value="Raised Bed 1">Raised Bed 1</option>
        <option value="Raised Bed 2">Raised Bed 2</option>
        <option value="Greenhouse">Greenhouse</option>
        <option value="Backyard Garden">Backyard Garden</option>
    </select>

    <label for="weight">Weight Harvested (lbs):</label>
    <input type="number" id="weight" step="0.1" required>

    <button type="button" onclick="addHarvest()">Add to List</button>
    <button type="button" onclick="submitAll()">Submit to Database</button>
</form>

<h3>Harvest List</h3>
<ul id="harvestList"></ul>
<p id="trackerMessage"></p>

<script>
    const plantNames = [
        "Cantaloupe", "Crookneck Squash", "Greek Pepperoncini Pepper", "Sunflower Mammoth Grey",
        "Echinacea", "Sunflower Lemon Queen", "Straightneck Squash", "Okra Baby Bubba Hybrid",
        "Cucumber Muncher variety", "Cucumber Picklebush variety", "Basil",
        "Tomato Chadwick Cherry", "Sunflower Autumn Beauty", "Bellpepper", "Sweet Pea Oregon Sugar Pod", "Tomato Brandywine",
        "Tomato Brandywine Pink", "Green Bean", "Zuchini", "Hollyhock Flowers", "Watermelon Sugar Baby",
        "Watermelon Crimson Sweet", "Watermelon Jubilee", "Nasturtium", "Spinach", "Cabbage", "Collards", "Broccoli",
        "Carolina Reaper Pepper", "Habanero Pepper", "Cauliflower", "Potatoes", "Strawberry", "Asparagus",
        "Blackberries", "Pumpkin", "Sugar Cane", "Thyme", "Basil", "Rosemary", "Sweet Potatoe", "Turnips",
        "Beets", "Scallion", "Onion Vidala", "Onion Red", "Rose", "Daffoldil"
    ];

    const plantSelect = document.getElementById("plantName");
    plantNames.forEach(name => {
        let option = document.createElement("option");
        option.value = name;
        option.textContent = name;
        plantSelect.appendChild(option);
    });

    let harvestEntries = [];

    function addHarvest() {
        const plant = document.getElementById("plantName").value;
        const date = document.getElementById("harvestDate").value;
        const location = document.getElementById("location").value;
        const weight = parseFloat(document.getElementById("weight").value);

        if (!plant || !date || !location || isNaN(weight)) {
            alert("Please fill out all fields.");
            return;
        }

        harvestEntries.push({ plant, date, location, weight });
        updateHarvestList();
    }

    function updateHarvestList() {
        const list = document.getElementById("harvestList");
        list.innerHTML = "";
        harvestEntries.forEach((entry, index) => {
            const li = document.createElement("li");
            li.textContent = `${entry.plant}, ${entry.date}, ${entry.location}, ${entry.weight} lbs`;
            list.appendChild(li);
        });
    }

    function submitAll() {
        if (harvestEntries.length === 0) {
            alert("No entries to submit.");
            return;
        }

        fetch('https://1ysvae9t7h.execute-api.us-east-1.amazonaws.com/prod/harvestEntryHandler', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ harvests: harvestEntries })
        })
        .then(response => {
            if (!response.ok) throw new Error("Network response was not ok");
            return response.json();
        })
        .then(data => {
            const messages = [
                "ğŸŒ» Way to grow!",
                "ğŸ‰ Harvest logged successfully!",
                "ğŸŒ¿ Keep up the great work!",
                "ğŸ… Another step toward our goal!",
                "ğŸ¥• You're doing amazing things!",
                "ğŸŒ» Keep growing!",
                "ğŸ‰ Great job, let's plant some more!",
                "ğŸŒ¿ Enjoy the fruits of your labor!",
                "ğŸ… I'm so proud of you!",
                "ğŸ¥• You're unstoppable!",
                "ğŸŒ» What a harvest!",
                "ğŸ‰ Wohoo, that's what I'm talking about!",
                "ğŸŒ¿ Bro that's an incredible harvest!",
                "ğŸ… Getting closer to hitting that goal, don't stop!",
                "ğŸ¥• You inspire me, keep going!"
            ];
            const message = messages[Math.floor(Math.random() * messages.length)];
            const trackerMessage = document.getElementById("trackerMessage");
            trackerMessage.textContent = message;
            trackerMessage.style.color = "green";

            setTimeout(() => {
                trackerMessage.textContent = "Ready for the next harvest!";
                trackerMessage.style.color = "";
            }, 15000);

            console.log("âœ… Success:", data);
            harvestEntries = [];
            updateHarvestList();
        })
        .catch(error => {
            console.error("âŒ Error submitting harvests:", error);
            document.getElementById("trackerMessage").textContent = "âŒ Error: Unable to submit your harvest. Please try again.";
        });
    }
</script>
