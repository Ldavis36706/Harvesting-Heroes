<!DOCTYPE html>
<html>

<head>
    <title>Harvesting Heroes</title>
    <link rel="icon" href="bountifulharvest.jpeg">
    <link rel="stylesheet" type="text/css" href="main.css">
</head>

<body>
    <div id="header">
        <table>
            <tr>
                <td><img src="bountifulharvest.jpeg"></td>
                <td>Harvesting Heroes</td>
            </tr>
        </table>
    </div>
    <div class="nav-menu">
        <a href="#harvests-link">Harvests</a>
        <a href="#our-mission-link">Our Mission</a>
        <a href="#grow-goal-link">Grow Goal</a>
        <a href="#about-us-link">About Us</a>
    </div>

    <!-- Harvests section -->
    <div class="products" id="harvests-link">
        <h2>Harvests</h2>
        <table>
            <tr>
                <td><img src="basketharvest.jpeg"><p>Bountiful Harvest</p></td>
                <td><img src="adamwatermelon.jpeg"><p>Adam Harvesting a Watermelon</p></td>
                <td><img src="hugewatermelon.jpeg"><p>Kesha's Huge Watermelon </p></td>
            </tr>
            <tr>
                <td><img src="shellingpeas.jpeg"><p>Shelling Peas</p></td>
                <td><img src="Malik & Nia harvesting onions.jpg"><p>Malik & Nia Onion Harvest</p></td>
                <td><img src="peaches.jpeg"><p>Peach Harvest</p></td>
            </tr>
        </table>
    </div>

    <!-- Grow Goal section with Harvest Tracker -->
    <div class="sidebar">
        <div class="location" id="grow-goal-link">
            <h2>Grow Goal</h2>
            <p>Our goal is to grow 500 lbs of food this season!</p>
            <div class="tracker-container">
                <h3>Harvest Tracker</h3>
                <p id="trackerMessage">Loading...</p>
            </div>
            <h2>Enter Harvest Data</h2>
            <form id="harvestForm">
                <label for="plantName">Plant Name:</label>
                <select id="plantName" required>
                    <option value="">Select a plant</option>
                    <option value="Tomato">Tomato</option>
                    <option value="Cabbage">Cabbage</option>
                    <option value="Carrot">Carrot</option>
                    <option value="Lettuce">Lettuce</option>
                </select>

                <label for="harvestDate">Harvest Date:</label>
                <input type="date" id="harvestDate" required>

                <label for="weight">Weight Harvested (lbs):</label>
                <input type="number" id="weight" step="0.1" required>

                <button type="button" onclick="addHarvest()">Add to List</button>
                <button type="button" onclick="submitHarvest()">Submit to Database</button>
            </form>
            <h3>Harvest List</h3>
            <ul id="harvestList"></ul>
        </div>
    </div>

    <div class="about-us" id="about-us-link">
        <h2>About Us</h2>
        <p>Welcome to Harvesting Heroes, where we show how easy it is to grow food, no matter your space or resources. Follow along on this exciting journey with us.</p>
    </div>

    <div class="services" id="our-mission-link">
        <h2>Our Mission</h2>
        <p>Grow Big. Harvest More. Inspire Others.</p>
    </div>
    
 <script>
    function addHarvest() {
        let plantName = document.getElementById("plantName").value;
        let harvestDate = document.getElementById("harvestDate").value;
        let harvestLocation = document.getElementById("harvestLocation").value;
        let weight = parseFloat(document.getElementById("weight").value);
        
        if (!plantName || !harvestDate || !harvestLocation || isNaN(weight)) {
            alert("Please fill out all fields before adding a harvest.");
            return;
        }

        let listItem = document.createElement("li");
        listItem.textContent = `${harvestDate} - ${plantName} (${harvestLocation}): ${weight} lbs`;
        
        let deleteButton = document.createElement("button");
        deleteButton.textContent = "Delete";
        deleteButton.onclick = function() { listItem.remove(); };
        
        listItem.appendChild(deleteButton);
        document.getElementById("harvestList").appendChild(listItem);
        document.getElementById("harvestForm").reset();
    }

    async function submitHarvest() {
        let plantName = document.getElementById("plantName").value;
        let harvestDate = document.getElementById("harvestDate").value;
        let harvestLocation = document.getElementById("harvestLocation").value;
        let weight = parseFloat(document.getElementById("weight").value);
        
        if (!plantName || !harvestDate || !harvestLocation || isNaN(weight)) {
            alert("Please fill out all fields before submitting.");
            return;
        }

        let payload = {
            PlantName: plantName,
            HarvestDate: harvestDate,
            HarvestLocation: harvestLocation,
            WeightHarvested: weight
        };

        try {
            let response = await fetch("https://your-api-gateway-url/harvest-entry", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(payload)
            });
            let result = await response.json();
            alert("✅ Submission Successful! Entry added to database.");
            location.reload();
        } catch (error) {
            alert("❌ Submission Failed. Please try again.");
        }
    }
  


        async function fetchTotalHarvest() {
            try {
                const response = await fetch("https://xev1gp9cab.execute-api.us-east-1.amazonaws.com/prod/GetTotalHarvestWeight");
                const data = await response.json();
                return data.totalWeight || 0;
            } catch (error) {
                console.error("Error fetching total harvest:", error);
                return 0;
            }
        }

        async function updateTracker() {
            try {
                const totalWeight = await fetchTotalHarvest();
                const goal = 500;
                let message = "Keep growing!";
                if (totalWeight >= 500) message = "500 lbs achieved! You're a Harvesting Hero!";
                else if (totalWeight >= 250) message = "Halfway there—keep going!";
                else if (totalWeight >= 100) message = "Great job! You’ve grown 100 lbs!";
                else if (totalWeight >= 50) message = "Awesome start! You’ve hit 50 lbs!";
                else if (totalWeight >= 25) message = "Awesome start! You’ve hit 25 lbs!";
                else if (totalWeight >= 20) message = "Awesome start! You’ve hit 20 lbs!";
                else if (totalWeight >= 15) message = "Awesome start! You’ve hit 15 lbs!";
                else if (totalWeight >= 10) message = "Awesome start! You’ve hit 10 lbs!";
                else if (totalWeight >= 5) message = "Awesome start! You’ve hit 5 lbs!";

                document.getElementById("trackerMessage").innerText = message;

                let progress = Math.min((totalWeight / goal) * 100, 100);
                document.getElementById("carrot").style.left = progress + "1%";
        } catch (error) {
            console.error("Error in updateTracker:", error);
        }
    }

</script>
</body>
</html>
